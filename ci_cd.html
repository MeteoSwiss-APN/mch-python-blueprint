<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CI / CD (Jenkins and GH Actions) &#8212; MCH Python Blueprint 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=2389946f"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Development Tools" href="development_tools.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ci-cd-jenkins-and-gh-actions">
<h1>CI / CD (Jenkins and GH Actions)<a class="headerlink" href="#ci-cd-jenkins-and-gh-actions" title="Permalink to this heading">¶</a></h1>
<p>The philosophy behind the default CI/CD setup that comes with the blueprint is that it is impossible to merge to the main branch without
running tests, formatters and linters. Two main frameworks are available: On the one hand, the invocation of pre-commit on a Github
actions workflow should check your unpinned environments on a Github actions server. This is important as it ensures that you do not run into compatibility
issues with the most recent versions of the packages in your dependency tree. On the other hand, the Jenkins pipeline tests production installations (pinned, non editable)
on CSCS machines. This is only required for packages that go into production.</p>
<section id="gh-actions-workflow">
<h2>GH Actions workflow<a class="headerlink" href="#gh-actions-workflow" title="Permalink to this heading">¶</a></h2>
<p>Upon merges to the main branch (and in pull requests), your package is built, formatted, checked and tested on a Github actions server.
You can check what is done in the workflow in <code class="code docutils literal notranslate"><span class="pre">.github/workflows/pre-commit.yml</span></code>.</p>
</section>
<section id="jenkins">
<h2>Jenkins<a class="headerlink" href="#jenkins" title="Permalink to this heading">¶</a></h2>
<p>If your code is going into production, it must be tested on CSCS machines with Jenkins. There are templates available in the <cite>jenkins/</cite> folder.
Contact DevOps to help you set up the Jenkins pipeline and to connect Jenkins to your repository.</p>
</section>
<section id="a-word-on-tox">
<h2>A word on tox<a class="headerlink" href="#a-word-on-tox" title="Permalink to this heading">¶</a></h2>
<p>Tox is a framework to automatically test multiple environments. If you plan to deploy your package (public) on Pypy or conda, it is a
good idea to adapt your GH actions workflow to make tox run pre-commit for different Python versions. This will ensure that users
downloading your package have some flexibility in package and Python versions. If you are at this point, you are probably experienced
enough to set up GH actions accordingly.</p>
<section id="tell-me-more-what-does-tox-do">
<h3>Tell me more: What does tox do?<a class="headerlink" href="#tell-me-more-what-does-tox-do" title="Permalink to this heading">¶</a></h3>
<p><a class="reference external" href="https://github.com/tox-dev/tox">Tox</a> is an automation framework to run arbitrary commands in isolated virtual environments.
In addition to running tools like the linters flake8, mypy or pylint that check the correctness of the code, tox can also easily be set up to run unit tests (e.g., with pytest) against multiple installed Python versions (e.g., 3.7, 3.8, 3.9) to ensure broad compatibility.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While less critical for end-user applications, ensuring compatibility with multiple Python versions is crucial for libraries that are used in other applications.</p>
</div>
<p>The fact that tox runs the tools isolated in virtual environments has the advantage that it also tests whether the project is properly installable.
For instance, if some necessary data files are not listed in MANIFEST.in and thus not copied alongside the code, this won’t be detected when tests are run directly in the working directory, but tox will fail because those files will be missing.
On the flip side, creating the virtual environment and installing the dependencies (or at least verifying that they are installed) introduces some overhead, which means that running fast unit tests may take significantly longer if run with tox.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MCH Python Blueprint</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="readme.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#contributing-to-the-blueprint-code">Contributing to the blueprint code</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ and Troubleshooting</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_tools.html">Development Tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CI / CD (Jenkins and GH Actions)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gh-actions-workflow">GH Actions workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jenkins">Jenkins</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-word-on-tox">A word on tox</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="development_tools.html" title="previous chapter">Development Tools</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, MeteoSwiss-APN.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/ci_cd.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>